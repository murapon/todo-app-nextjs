# https://taskfile.dev

version: '3'

tasks:
  # ===================
  # æ—¥å¸¸ã®é–‹ç™ºã‚³ãƒãƒ³ãƒ‰
  # ===================
  
  up:
    desc: "ğŸš€ é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆDB + Next.jsï¼‰"
    cmds:
      - docker compose up
    silent: true

  down:
    desc: "â¹ï¸ é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢"
    cmds:
      - docker compose down
    silent: true

  # ===================
  # DBé–¢é€£ã‚³ãƒãƒ³ãƒ‰
  # ===================

  migrate:
    desc: "ğŸ“¦ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ"
    cmds:
      - docker compose run --rm next sh -c "corepack enable && npx prisma migrate dev"
    silent: true

  generate:
    desc: "ğŸ”§ Prisma Clientã‚’ç”Ÿæˆ"
    cmds:
      - docker compose run --rm next sh -c "corepack enable && npx prisma generate"
    silent: true

  seed:
    desc: "ğŸŒ± ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥"
    cmds:
      - docker compose run --rm next sh -c "corepack enable && npx prisma db seed"
    silent: true

  seed-demo:
    desc: "ğŸ² ãƒ‡ãƒ¢ç”¨ã‚¿ã‚¹ã‚¯100ä»¶ã‚’ç”Ÿæˆ"
    cmds:
      - docker compose run --rm next sh -c "corepack enable && npx tsx prisma/seed-demo.ts"
    silent: true

  reset:
    desc: "ğŸ”„ DBã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿å…¨å‰Šé™¤ + ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ + ã‚·ãƒ¼ãƒ‰ï¼‰"
    cmds:
      - docker compose run --rm next sh -c "corepack enable && npx prisma migrate reset --force"
    silent: true

  studio:
    desc: "ğŸ” Prisma Studioã‚’èµ·å‹•ï¼ˆDBãƒ“ãƒ¥ãƒ¼ã‚¢ï¼‰"
    cmds:
      - docker compose run --rm -p 5555:5555 next sh -c "corepack enable && npx prisma studio"
    silent: true
